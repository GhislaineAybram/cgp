<div class="bg-white-light py-12 sm:py-16">
  <div class="mx-auto max-w-7xl px-6 lg:px-8">
    <div class="mx-auto lg:mx-0">
      <h2 class="text-3xl font-bold text-center tracking-tight text-pretty color-blue sm:text-4xl lg:text-5xl section-line">
        Mes partenaires
      </h2>
      <p class="mt-6 text-base text-gray-700 leading-relaxed sm:text-lg w-full">
        Découvrez à travers ces vidéos les professionnels qui m'accompagnent dans votre réussite financière.
      </p>
    </div>

    @if (isLoading) {
      <p class="text-center py-8 text-gray-500">
        Chargement des vidéos en cours...
      </p>
    } @else {
    <div
      class="mx-auto mt-10 grid max-w-2xl grid-cols-1 gap-x-8 gap-y-16 md:grid-cols-2 lg:mx-0 lg:max-w-none lg:grid-cols-3"
      >
      @for (media of medias; track media.id) {
      <article class="flex flex-col p-3 h-full bg-grey-very-light rounded-2xl overflow-hidden shadow-sm">
        <!-- En-tête avec date et channel -->
        <div class="flex justify-between items-center mb-2">
          <time *ngIf="media.date" class="text-sm color-grey-dark">
            {{ media.date | date: 'd MMMM yyyy' : '':'fr' }}
          </time>
          <p class="relative p-2 z-10 rounded-full bg-bronze-light py-1.5 text-xs font-medium color-blue-dark">
            {{ media.channel }}
          </p>
        </div>

        <!-- Miniature vidéo en haut -->
        <div class="relative mb-4">
          <a [href]="media.link" target="_blank" rel="noopener noreferrer" class="block">
            <img
              [src]="getMediaThumbnail(media.link)"
              alt="aperçu vidéo"
              class="w-full h-48 object-cover rounded-lg hover:opacity-90 transition-opacity"
            />
            <!-- Icône play -->
            <div class="absolute inset-0 flex items-center justify-center">
              <div class="bg-black bg-opacity-60 rounded-full p-3 hover:bg-opacity-80 transition-all">
                <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M8 5v14l11-7z"/>
                </svg>
              </div>
            </div>
          </a>
        </div>

        <!-- Contenu textuel -->
        <div class="flex-1 flex flex-col">

          <h3 class="text-lg font-semibold color-blue mb-2 min-h-[4.5rem] leading-snug">
              {{ media.title }}
          </h3>
          
          <div class="text-sm color-grey-dark relative">
          <p>
            <span *ngIf="!mediasService.isTextExpanded(media.id) && mediasService.shouldShowToggle(media.text)">
              {{ media.text | slice:0:250 }}...
            </span>
            <span *ngIf="mediasService.isTextExpanded(media.id) || !mediasService.shouldShowToggle(media.text)">
              {{ media.text }}
            </span>
            <button
              *ngIf="mediasService.shouldShowToggle(media.text)"
              (click)="mediasService.toggleText(media.id)"
            >
              {{ mediasService.isTextExpanded(media.id) ? 'Voir moins' : 'Voir plus' }}
            </button>
          </p>
          </div>
          
        </div>

      </article>
    }

    </div>
        <div class="flex justify-end">
      <button
        type="submit"
        class="mt-6 ml-auto px-3.5 py-2.5 text-center text-sm font-semibold button-action"
        routerLink="/"
      >
        Retour vers la page d'accueil
      </button>
    </div>
  }
  </div>
</div>
